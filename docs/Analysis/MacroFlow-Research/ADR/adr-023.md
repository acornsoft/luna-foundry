# ADR 023: Adopt SpecFlow + LivingDoc for Living Specifications in Luna Foundry

## Status

Accepted

## Context

Luna Foundry requires living documentation that remains synchronized with code and tests, ensuring specifications are executable, stakeholder-friendly, and driven by first principles and critical thinking. Current documentation risks becoming outdated without automated syncing.

## Decision

Adopt SpecFlow for defining agent behaviors in Gherkin feature files, backed by xUnit/NUnit integration tests, with SpecFlow+ LivingDoc for auto-generating living documentation from test execution results. This provides executable specs that stay current with code changes.

## Consequences

- Positive: Executable specs, auto-updating docs tied to test runs, better traceability, stakeholder engagement via readable Gherkin.
- Negative: Additional tooling setup (SpecFlow packages, LivingDoc CLI), learning curve for Gherkin syntax.
- Risks: Tool compatibility with .NET ecosystem, potential overhead in CI/CD pipelines.

## Implementation

- Add SpecFlow NuGet packages (SpecFlow, SpecFlow.xUnit) to test projects.
- Create feature files per agent (e.g., Clarify.feature with scenarios for question handling, context gathering).
- Implement step definitions and integration tests.
- Configure LivingDoc in CI/CD pipeline to run tests and generate/publish docs (e.g., as GitHub Pages or ADO wiki).
- Require feature files for all agent capabilities, with LivingDoc links in repo docs.

## Alternatives Considered

- Manual docs: Prone to staleness.
- Other BDD tools: SpecFlow is mature for .NET.

## Notes

This aligns with MacroFlow's truth-seeking by making specs testable and reactive to real-world development.